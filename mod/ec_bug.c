#include "../ecf.h"
#include <bugcodes.h>

#ifndef XBOX_ERACTRL_CS_TIMEOUT
#define XBOX_ERACTRL_CS_TIMEOUT 0x356
#endif

static ErrorCodeItem ec_bug_items[] = {
    REGCODE(HARDWARE_PROFILE_UNDOCKED_STRING)
    REGCODE(HARDWARE_PROFILE_DOCKED_STRING)
    REGCODE(HARDWARE_PROFILE_UNKNOWN_STRING)
    REGCODE(WINDOWS_NT_BANNER)
    REGCODE(WINDOWS_NT_CSD_STRING)
    REGCODE(WINDOWS_NT_INFO_STRING)
    REGCODE(WINDOWS_NT_MP_STRING)
    REGCODE(THREAD_TERMINATE_HELD_MUTEX)
    REGCODE(WINDOWS_NT_INFO_STRING_PLURAL)
    REGCODE(WINDOWS_NT_RC_STRING)
    REGCODE(APC_INDEX_MISMATCH)
    REGCODE(DEVICE_QUEUE_NOT_BUSY)
    REGCODE(INVALID_AFFINITY_SET)
    REGCODE(INVALID_DATA_ACCESS_TRAP)
    REGCODE(INVALID_PROCESS_ATTACH_ATTEMPT)
    REGCODE(INVALID_PROCESS_DETACH_ATTEMPT)
    REGCODE(INVALID_SOFTWARE_INTERRUPT)
    REGCODE(IRQL_NOT_DISPATCH_LEVEL)
    REGCODE(IRQL_NOT_GREATER_OR_EQUAL)
    REGCODE(IRQL_NOT_LESS_OR_EQUAL)
    REGCODE(NO_EXCEPTION_HANDLING_SUPPORT)
    REGCODE(MAXIMUM_WAIT_OBJECTS_EXCEEDED)
    REGCODE(MUTEX_LEVEL_NUMBER_VIOLATION)
    REGCODE(NO_USER_MODE_CONTEXT)
    REGCODE(SPIN_LOCK_ALREADY_OWNED)
    REGCODE(SPIN_LOCK_NOT_OWNED)
    REGCODE(THREAD_NOT_MUTEX_OWNER)
    REGCODE(TRAP_CAUSE_UNKNOWN)
    REGCODE(EMPTY_THREAD_REAPER_LIST)
    REGCODE(CREATE_DELETE_LOCK_NOT_LOCKED)
    REGCODE(LAST_CHANCE_CALLED_FROM_KMODE)
    REGCODE(CID_HANDLE_CREATION)
    REGCODE(CID_HANDLE_DELETION)
    REGCODE(REFERENCE_BY_POINTER)
    REGCODE(BAD_POOL_HEADER)
    REGCODE(MEMORY_MANAGEMENT)
    REGCODE(PFN_SHARE_COUNT)
    REGCODE(PFN_REFERENCE_COUNT)
    REGCODE(NO_SPIN_LOCK_AVAILABLE)
    REGCODE(KMODE_EXCEPTION_NOT_HANDLED)
    REGCODE(SHARED_RESOURCE_CONV_ERROR)
    REGCODE(KERNEL_APC_PENDING_DURING_EXIT)
    REGCODE(QUOTA_UNDERFLOW)
    REGCODE(FILE_SYSTEM)
    REGCODE(FAT_FILE_SYSTEM)
    REGCODE(NTFS_FILE_SYSTEM)
    REGCODE(NPFS_FILE_SYSTEM)
    REGCODE(CDFS_FILE_SYSTEM)
    REGCODE(RDR_FILE_SYSTEM)
    REGCODE(CORRUPT_ACCESS_TOKEN)
    REGCODE(SECURITY_SYSTEM)
    REGCODE(INCONSISTENT_IRP)
    REGCODE(PANIC_STACK_SWITCH)
    REGCODE(PORT_DRIVER_INTERNAL)
    REGCODE(SCSI_DISK_DRIVER_INTERNAL)
    REGCODE(DATA_BUS_ERROR)
    REGCODE(INSTRUCTION_BUS_ERROR)
    REGCODE(SET_OF_INVALID_CONTEXT)
    REGCODE(PHASE0_INITIALIZATION_FAILED)
    REGCODE(PHASE1_INITIALIZATION_FAILED)
    REGCODE(UNEXPECTED_INITIALIZATION_CALL)
    REGCODE(CACHE_MANAGER)
    REGCODE(NO_MORE_IRP_STACK_LOCATIONS)
    REGCODE(DEVICE_REFERENCE_COUNT_NOT_ZERO)
    REGCODE(FLOPPY_INTERNAL_ERROR)
    REGCODE(SERIAL_DRIVER_INTERNAL)
    REGCODE(SYSTEM_EXIT_OWNED_MUTEX)
    REGCODE(SYSTEM_UNWIND_PREVIOUS_USER)
    REGCODE(SYSTEM_SERVICE_EXCEPTION)
    REGCODE(INTERRUPT_UNWIND_ATTEMPTED)
    REGCODE(INTERRUPT_EXCEPTION_NOT_HANDLED)
    REGCODE(MULTIPROCESSOR_CONFIGURATION_NOT_SUPPORTED)
    REGCODE(NO_MORE_SYSTEM_PTES)
    REGCODE(TARGET_MDL_TOO_SMALL)
    REGCODE(MUST_SUCCEED_POOL_EMPTY)
    REGCODE(ATDISK_DRIVER_INTERNAL)
    REGCODE(NO_SUCH_PARTITION)
    REGCODE(MULTIPLE_IRP_COMPLETE_REQUESTS)
    REGCODE(INSUFFICIENT_SYSTEM_MAP_REGS)
    REGCODE(DEREF_UNKNOWN_LOGON_SESSION)
    REGCODE(REF_UNKNOWN_LOGON_SESSION)
    REGCODE(CANCEL_STATE_IN_COMPLETED_IRP)
    REGCODE(PAGE_FAULT_WITH_INTERRUPTS_OFF)
    REGCODE(IRQL_GT_ZERO_AT_SYSTEM_SERVICE)
    REGCODE(STREAMS_INTERNAL_ERROR)
    REGCODE(FATAL_UNHANDLED_HARD_ERROR)
    REGCODE(NO_PAGES_AVAILABLE)
    REGCODE(PFN_LIST_CORRUPT)
    REGCODE(NDIS_INTERNAL_ERROR)
    REGCODE(PAGE_FAULT_IN_NONPAGED_AREA)
    REGCODE(PAGE_FAULT_IN_NONPAGED_AREA_M)
    REGCODE(REGISTRY_ERROR)
    REGCODE(MAILSLOT_FILE_SYSTEM)
    REGCODE(NO_BOOT_DEVICE)
    REGCODE(LM_SERVER_INTERNAL_ERROR)
    REGCODE(DATA_COHERENCY_EXCEPTION)
    REGCODE(INSTRUCTION_COHERENCY_EXCEPTION)
    REGCODE(XNS_INTERNAL_ERROR)
    REGCODE(VOLMGRX_INTERNAL_ERROR)
    REGCODE(PINBALL_FILE_SYSTEM)
    REGCODE(CRITICAL_SERVICE_FAILED)
    REGCODE(SET_ENV_VAR_FAILED)
    REGCODE(HAL_INITIALIZATION_FAILED)
    REGCODE(UNSUPPORTED_PROCESSOR)
    REGCODE(OBJECT_INITIALIZATION_FAILED)
    REGCODE(SECURITY_INITIALIZATION_FAILED)
    REGCODE(PROCESS_INITIALIZATION_FAILED)
    REGCODE(HAL1_INITIALIZATION_FAILED)
    REGCODE(OBJECT1_INITIALIZATION_FAILED)
    REGCODE(SECURITY1_INITIALIZATION_FAILED)
    REGCODE(SYMBOLIC_INITIALIZATION_FAILED)
    REGCODE(MEMORY1_INITIALIZATION_FAILED)
    REGCODE(CACHE_INITIALIZATION_FAILED)
    REGCODE(CONFIG_INITIALIZATION_FAILED)
    REGCODE(FILE_INITIALIZATION_FAILED)
    REGCODE(IO1_INITIALIZATION_FAILED)
    REGCODE(LPC_INITIALIZATION_FAILED)
    REGCODE(PROCESS1_INITIALIZATION_FAILED)
    REGCODE(REFMON_INITIALIZATION_FAILED)
    REGCODE(SESSION1_INITIALIZATION_FAILED)
    REGCODE(BOOTPROC_INITIALIZATION_FAILED)
    REGCODE(VSL_INITIALIZATION_FAILED)
    REGCODE(SOFT_RESTART_FATAL_ERROR)
    REGCODE(ASSIGN_DRIVE_LETTERS_FAILED)
    REGCODE(CONFIG_LIST_FAILED)
    REGCODE(BAD_SYSTEM_CONFIG_INFO)
    REGCODE(CANNOT_WRITE_CONFIGURATION)
    REGCODE(PROCESS_HAS_LOCKED_PAGES)
    REGCODE(KERNEL_STACK_INPAGE_ERROR)
    REGCODE(PHASE0_EXCEPTION)
    REGCODE(MISMATCHED_HAL)
    REGCODE(KERNEL_DATA_INPAGE_ERROR)
    REGCODE(INACCESSIBLE_BOOT_DEVICE)
    REGCODE(BUGCODE_NDIS_DRIVER)
    REGCODE(INSTALL_MORE_MEMORY)
    REGCODE(SYSTEM_THREAD_EXCEPTION_NOT_HANDLED)
    REGCODE(SYSTEM_THREAD_EXCEPTION_NOT_HANDLED_M)
    REGCODE(UNEXPECTED_KERNEL_MODE_TRAP)
    REGCODE(UNEXPECTED_KERNEL_MODE_TRAP_M)
    REGCODE(NMI_HARDWARE_FAILURE)
    REGCODE(SPIN_LOCK_INIT_FAILURE)
    REGCODE(DFS_FILE_SYSTEM)
    REGCODE(OFS_FILE_SYSTEM)
    REGCODE(RECOM_DRIVER)
    REGCODE(SETUP_FAILURE)
    REGCODE(AUDIT_FAILURE)
    REGCODE(MBR_CHECKSUM_MISMATCH)
    REGCODE(KERNEL_MODE_EXCEPTION_NOT_HANDLED)
    REGCODE(KERNEL_MODE_EXCEPTION_NOT_HANDLED_M)
    REGCODE(PP0_INITIALIZATION_FAILED)
    REGCODE(PP1_INITIALIZATION_FAILED)
    REGCODE(WIN32K_INIT_OR_RIT_FAILURE)
    REGCODE(UP_DRIVER_ON_MP_SYSTEM)
    REGCODE(INVALID_KERNEL_HANDLE)
    REGCODE(KERNEL_STACK_LOCKED_AT_EXIT)
    REGCODE(PNP_INTERNAL_ERROR)
    REGCODE(INVALID_WORK_QUEUE_ITEM)
    REGCODE(BOUND_IMAGE_UNSUPPORTED)
    REGCODE(END_OF_NT_EVALUATION_PERIOD)
    REGCODE(INVALID_REGION_OR_SEGMENT)
    REGCODE(SYSTEM_LICENSE_VIOLATION)
    REGCODE(UDFS_FILE_SYSTEM)
    REGCODE(MACHINE_CHECK_EXCEPTION)
    REGCODE(USER_MODE_HEALTH_MONITOR)
    REGCODE(DRIVER_POWER_STATE_FAILURE)
    REGCODE(INTERNAL_POWER_ERROR)
    REGCODE(PCI_BUS_DRIVER_INTERNAL)
    REGCODE(MEMORY_IMAGE_CORRUPT)
    REGCODE(ACPI_DRIVER_INTERNAL)
    REGCODE(CNSS_FILE_SYSTEM_FILTER)
    REGCODE(ACPI_BIOS_ERROR)
    REGCODE(FP_EMULATION_ERROR)
    REGCODE(BAD_EXHANDLE)
    REGCODE(BOOTING_IN_SAFEMODE_MINIMAL)
    REGCODE(BOOTING_IN_SAFEMODE_NETWORK)
    REGCODE(BOOTING_IN_SAFEMODE_DSREPAIR)
    REGCODE(SESSION_HAS_VALID_POOL_ON_EXIT)
    REGCODE(HAL_MEMORY_ALLOCATION)
    REGCODE(VIDEO_DRIVER_DEBUG_REPORT_REQUEST)
    REGCODE(BGI_DETECTED_VIOLATION)
    REGCODE(VIDEO_DRIVER_INIT_FAILURE)
    REGCODE(BOOTLOG_LOADED)
    REGCODE(BOOTLOG_NOT_LOADED)
    REGCODE(BOOTLOG_ENABLED)
    REGCODE(ATTEMPTED_SWITCH_FROM_DPC)
    REGCODE(CHIPSET_DETECTED_ERROR)
    REGCODE(SESSION_HAS_VALID_VIEWS_ON_EXIT)
    REGCODE(NETWORK_BOOT_INITIALIZATION_FAILED)
    REGCODE(NETWORK_BOOT_DUPLICATE_ADDRESS)
    REGCODE(INVALID_HIBERNATED_STATE)
    REGCODE(ATTEMPTED_WRITE_TO_READONLY_MEMORY)
    REGCODE(MUTEX_ALREADY_OWNED)
    REGCODE(PCI_CONFIG_SPACE_ACCESS_FAILURE)
    REGCODE(SPECIAL_POOL_DETECTED_MEMORY_CORRUPTION)
    REGCODE(BAD_POOL_CALLER)
    REGCODE(SYSTEM_IMAGE_BAD_SIGNATURE)
    REGCODE(DRIVER_VERIFIER_DETECTED_VIOLATION)
    REGCODE(DRIVER_CORRUPTED_EXPOOL)
    REGCODE(DRIVER_CAUGHT_MODIFYING_FREED_POOL)
    REGCODE(TIMER_OR_DPC_INVALID)
    REGCODE(IRQL_UNEXPECTED_VALUE)
    REGCODE(DRIVER_VERIFIER_IOMANAGER_VIOLATION)
    REGCODE(PNP_DETECTED_FATAL_ERROR)
    REGCODE(DRIVER_LEFT_LOCKED_PAGES_IN_PROCESS)
    REGCODE(PAGE_FAULT_IN_FREED_SPECIAL_POOL)
    REGCODE(PAGE_FAULT_BEYOND_END_OF_ALLOCATION)
    REGCODE(DRIVER_UNLOADED_WITHOUT_CANCELLING_PENDING_OPERATIONS)
    REGCODE(TERMINAL_SERVER_DRIVER_MADE_INCORRECT_MEMORY_REFERENCE)
    REGCODE(DRIVER_CORRUPTED_MMPOOL)
    REGCODE(DRIVER_IRQL_NOT_LESS_OR_EQUAL)
    REGCODE(BUGCODE_ID_DRIVER)
    REGCODE(DRIVER_PORTION_MUST_BE_NONPAGED)
    REGCODE(SYSTEM_SCAN_AT_RAISED_IRQL_CAUGHT_IMPROPER_DRIVER_UNLOAD)
    REGCODE(DRIVER_PAGE_FAULT_IN_FREED_SPECIAL_POOL)
    REGCODE(DRIVER_PAGE_FAULT_BEYOND_END_OF_ALLOCATION)
    REGCODE(DRIVER_PAGE_FAULT_BEYOND_END_OF_ALLOCATION_M)
    REGCODE(DRIVER_UNMAPPING_INVALID_VIEW)
    REGCODE(DRIVER_USED_EXCESSIVE_PTES)
    REGCODE(LOCKED_PAGES_TRACKER_CORRUPTION)
    REGCODE(SYSTEM_PTE_MISUSE)
    REGCODE(DRIVER_CORRUPTED_SYSPTES)
    REGCODE(DRIVER_INVALID_STACK_ACCESS)
    REGCODE(POOL_CORRUPTION_IN_FILE_AREA)
    REGCODE(IMPERSONATING_WORKER_THREAD)
    REGCODE(ACPI_BIOS_FATAL_ERROR)
    REGCODE(WORKER_THREAD_RETURNED_AT_BAD_IRQL)
    REGCODE(MANUALLY_INITIATED_CRASH)
    REGCODE(RESOURCE_NOT_OWNED)
    REGCODE(WORKER_INVALID)
    REGCODE(POWER_FAILURE_SIMULATE)
    REGCODE(DRIVER_VERIFIER_DMA_VIOLATION)
    REGCODE(INVALID_FLOATING_POINT_STATE)
    REGCODE(INVALID_CANCEL_OF_FILE_OPEN)
    REGCODE(ACTIVE_EX_WORKER_THREAD_TERMINATION)
    REGCODE(SAVER_UNSPECIFIED)
    REGCODE(SAVER_BLANKSCREEN)
    REGCODE(SAVER_INPUT)
    REGCODE(SAVER_WATCHDOG)
    REGCODE(SAVER_STARTNOTVISIBLE)
    REGCODE(SAVER_NAVIGATIONMODEL)
    REGCODE(SAVER_OUTOFMEMORY)
    REGCODE(SAVER_GRAPHICS)
    REGCODE(SAVER_NAVSERVERTIMEOUT)
    REGCODE(SAVER_CHROMEPROCESSCRASH)
    REGCODE(SAVER_NOTIFICATIONDISMISSAL)
    REGCODE(SAVER_SPEECHDISMISSAL)
    REGCODE(SAVER_CALLDISMISSAL)
    REGCODE(SAVER_APPBARDISMISSAL)
    REGCODE(SAVER_RILADAPTATIONCRASH)
    REGCODE(SAVER_APPLISTUNREACHABLE)
    REGCODE(SAVER_REPORTNOTIFICATIONFAILURE)
    REGCODE(SAVER_UNEXPECTEDSHUTDOWN)
    REGCODE(SAVER_RPCFAILURE)
    REGCODE(SAVER_AUXILIARYFULLDUMP)
    REGCODE(SAVER_ACCOUNTPROVSVCINITFAILURE)
    REGCODE(SAVER_MTBFCOMMANDTIMEOUT)
    REGCODE(SAVER_MTBFCOMMANDHANG)
    REGCODE(SAVER_MTBFPASSBUGCHECK)
    REGCODE(SAVER_MTBFIOERROR)
    REGCODE(SAVER_RENDERTHREADHANG)
    REGCODE(SAVER_RENDERMOBILEUIOOM)
    REGCODE(SAVER_DEVICEUPDATEUNSPECIFIED)
    REGCODE(SAVER_AUDIODRIVERHANG)
    REGCODE(SAVER_BATTERYPULLOUT)
    REGCODE(SAVER_MEDIACORETESTHANG)
    REGCODE(SAVER_RESOURCEMANAGEMENT)
    REGCODE(SAVER_CAPTURESERVICE)
    REGCODE(SAVER_WAITFORSHELLREADY)
    REGCODE(SAVER_NONRESPONSIVEPROCESS)
    REGCODE(SAVER_SICKAPPLICATION)
    REGCODE(THREAD_STUCK_IN_DEVICE_DRIVER)
    REGCODE(THREAD_STUCK_IN_DEVICE_DRIVER_M)
    REGCODE(DIRTY_MAPPED_PAGES_CONGESTION)
    REGCODE(SESSION_HAS_VALID_SPECIAL_POOL_ON_EXIT)
    REGCODE(UNMOUNTABLE_BOOT_VOLUME)
    REGCODE(CRITICAL_PROCESS_DIED)
    REGCODE(STORAGE_MINIPORT_ERROR)
    REGCODE(SCSI_VERIFIER_DETECTED_VIOLATION)
    REGCODE(HARDWARE_INTERRUPT_STORM)
    REGCODE(DISORDERLY_SHUTDOWN)
    REGCODE(CRITICAL_OBJECT_TERMINATION)
    REGCODE(FLTMGR_FILE_SYSTEM)
    REGCODE(PCI_VERIFIER_DETECTED_VIOLATION)
    REGCODE(DRIVER_OVERRAN_STACK_BUFFER)
    REGCODE(RAMDISK_BOOT_INITIALIZATION_FAILED)
    REGCODE(DRIVER_RETURNED_STATUS_REPARSE_FOR_VOLUME_OPEN)
    REGCODE(HTTP_DRIVER_CORRUPTED)
    REGCODE(RECURSIVE_MACHINE_CHECK)
    REGCODE(ATTEMPTED_EXECUTE_OF_NOEXECUTE_MEMORY)
    REGCODE(DIRTY_NOWRITE_PAGES_CONGESTION)
    REGCODE(BUGCODE_USB_DRIVER)
    REGCODE(BC_BLUETOOTH_VERIFIER_FAULT)
    REGCODE(BC_BTHMINI_VERIFIER_FAULT)
    REGCODE(RESERVE_QUEUE_OVERFLOW)
    REGCODE(LOADER_BLOCK_MISMATCH)
    REGCODE(CLOCK_WATCHDOG_TIMEOUT)
    REGCODE(DPC_WATCHDOG_TIMEOUT)
    REGCODE(MUP_FILE_SYSTEM)
    REGCODE(AGP_INVALID_ACCESS)
    REGCODE(AGP_GART_CORRUPTION)
    REGCODE(AGP_ILLEGALLY_REPROGRAMMED)
    REGCODE(KERNEL_EXPAND_STACK_ACTIVE)
    REGCODE(THIRD_PARTY_FILE_SYSTEM_FAILURE)
    REGCODE(CRITICAL_STRUCTURE_CORRUPTION)
    REGCODE(APP_TAGGING_INITIALIZATION_FAILED)
    REGCODE(DFSC_FILE_SYSTEM)
    REGCODE(FSRTL_EXTRA_CREATE_PARAMETER_VIOLATION)
    REGCODE(WDF_VIOLATION)
    REGCODE(VIDEO_MEMORY_MANAGEMENT_INTERNAL)
    REGCODE(DRIVER_INVALID_CRUNTIME_PARAMETER)
    REGCODE(RECURSIVE_NMI)
    REGCODE(MSRPC_STATE_VIOLATION)
    REGCODE(VIDEO_DXGKRNL_FATAL_ERROR)
    REGCODE(VIDEO_SHADOW_DRIVER_FATAL_ERROR)
    REGCODE(AGP_INTERNAL)
    REGCODE(VIDEO_TDR_FAILURE)
    REGCODE(VIDEO_TDR_TIMEOUT_DETECTED)
    REGCODE(NTHV_GUEST_ERROR)
    REGCODE(VIDEO_SCHEDULER_INTERNAL_ERROR)
    REGCODE(EM_INITIALIZATION_ERROR)
    REGCODE(DRIVER_RETURNED_HOLDING_CANCEL_LOCK)
    REGCODE(ATTEMPTED_WRITE_TO_CM_PROTECTED_STORAGE)
    REGCODE(EVENT_TRACING_FATAL_ERROR)
    REGCODE(TOO_MANY_RECURSIVE_FAULTS)
    REGCODE(INVALID_DRIVER_HANDLE)
    REGCODE(BITLOCKER_FATAL_ERROR)
    REGCODE(DRIVER_VIOLATION)
    REGCODE(WHEA_INTERNAL_ERROR)
    REGCODE(CRYPTO_SELF_TEST_FAILURE)
    REGCODE(WHEA_UNCORRECTABLE_ERROR)
    REGCODE(NMR_INVALID_STATE)
    REGCODE(NETIO_INVALID_POOL_CALLER)
    REGCODE(PAGE_NOT_ZERO)
    REGCODE(WORKER_THREAD_RETURNED_WITH_BAD_IO_PRIORITY)
    REGCODE(WORKER_THREAD_RETURNED_WITH_BAD_PAGING_IO_PRIORITY)
    REGCODE(MUI_NO_VALID_SYSTEM_LANGUAGE)
    REGCODE(FAULTY_HARDWARE_CORRUPTED_PAGE)
    REGCODE(EXFAT_FILE_SYSTEM)
    REGCODE(VOLSNAP_OVERLAPPED_TABLE_ACCESS)
    REGCODE(INVALID_MDL_RANGE)
    REGCODE(VHD_BOOT_INITIALIZATION_FAILED)
    REGCODE(DYNAMIC_ADD_PROCESSOR_MISMATCH)
    REGCODE(INVALID_EXTENDED_PROCESSOR_STATE)
    REGCODE(RESOURCE_OWNER_POINTER_INVALID)
    REGCODE(DPC_WATCHDOG_VIOLATION)
    REGCODE(DRIVE_EXTENDER)
    REGCODE(REGISTRY_FILTER_DRIVER_EXCEPTION)
    REGCODE(VHD_BOOT_HOST_VOLUME_NOT_ENOUGH_SPACE)
    REGCODE(WIN32K_HANDLE_MANAGER)
    REGCODE(GPIO_CONTROLLER_DRIVER_ERROR)
    REGCODE(KERNEL_SECURITY_CHECK_FAILURE)
    REGCODE(KERNEL_MODE_HEAP_CORRUPTION)
    REGCODE(PASSIVE_INTERRUPT_ERROR)
    REGCODE(INVALID_IO_BOOST_STATE)
    REGCODE(CRITICAL_INITIALIZATION_FAILURE)
    REGCODE(ERRATA_WORKAROUND_UNSUCCESSFUL)
    REGCODE(STORAGE_DEVICE_ABNORMALITY_DETECTED)
    REGCODE(VIDEO_ENGINE_TIMEOUT_DETECTED)
    REGCODE(VIDEO_TDR_APPLICATION_BLOCKED)
    REGCODE(PROCESSOR_DRIVER_INTERNAL)
    REGCODE(BUGCODE_USB3_DRIVER)
    REGCODE(SECURE_BOOT_VIOLATION)
    REGCODE(NDIS_NET_BUFFER_LIST_INFO_ILLEGALLY_TRANSFERRED)
    REGCODE(ABNORMAL_RESET_DETECTED)
    REGCODE(IO_OBJECT_INVALID)
    REGCODE(REFS_FILE_SYSTEM)
    REGCODE(KERNEL_WMI_INTERNAL)
    REGCODE(SOC_SUBSYSTEM_FAILURE)
    REGCODE(FATAL_ABNORMAL_RESET_ERROR)
    REGCODE(EXCEPTION_SCOPE_INVALID)
    REGCODE(SOC_CRITICAL_DEVICE_REMOVED)
    REGCODE(PDC_WATCHDOG_TIMEOUT)
    REGCODE(TCPIP_AOAC_NIC_ACTIVE_REFERENCE_LEAK)
    REGCODE(UNSUPPORTED_INSTRUCTION_MODE)
    REGCODE(INVALID_PUSH_LOCK_FLAGS)
    REGCODE(KERNEL_LOCK_ENTRY_LEAKED_ON_THREAD_TERMINATION)
    REGCODE(UNEXPECTED_STORE_EXCEPTION)
    REGCODE(OS_DATA_TAMPERING)
    REGCODE(WINSOCK_DETECTED_HUNG_CLOSESOCKET_LIVEDUMP)
    REGCODE(KERNEL_THREAD_PRIORITY_FLOOR_VIOLATION)
    REGCODE(ILLEGAL_IOMMU_PAGE_FAULT)
    REGCODE(HAL_ILLEGAL_IOMMU_PAGE_FAULT)
    REGCODE(SDBUS_INTERNAL_ERROR)
    REGCODE(WORKER_THREAD_RETURNED_WITH_SYSTEM_PAGE_PRIORITY_ACTIVE)
    REGCODE(PDC_WATCHDOG_TIMEOUT_LIVEDUMP)
    REGCODE(SOC_SUBSYSTEM_FAILURE_LIVEDUMP)
    REGCODE(BUGCODE_NDIS_DRIVER_LIVE_DUMP)
    REGCODE(CONNECTED_STANDBY_WATCHDOG_TIMEOUT_LIVEDUMP)
    REGCODE(WIN32K_ATOMIC_CHECK_FAILURE)
    REGCODE(LIVE_SYSTEM_DUMP)
    REGCODE(KERNEL_AUTO_BOOST_INVALID_LOCK_RELEASE)
    REGCODE(WORKER_THREAD_TEST_CONDITION)
    REGCODE(WIN32K_CRITICAL_FAILURE)
    REGCODE(CLUSTER_CSV_STATUS_IO_TIMEOUT_LIVEDUMP)
    REGCODE(CLUSTER_RESOURCE_CALL_TIMEOUT_LIVEDUMP)
    REGCODE(CLUSTER_CSV_SNAPSHOT_DEVICE_INFO_TIMEOUT_LIVEDUMP)
    REGCODE(CLUSTER_CSV_STATE_TRANSITION_TIMEOUT_LIVEDUMP)
    REGCODE(CLUSTER_CSV_VOLUME_ARRIVAL_LIVEDUMP)
    REGCODE(CLUSTER_CSV_VOLUME_REMOVAL_LIVEDUMP)
    REGCODE(CLUSTER_CSV_CLUSTER_WATCHDOG_LIVEDUMP)
    REGCODE(INVALID_RUNDOWN_PROTECTION_FLAGS)
    REGCODE(INVALID_SLOT_ALLOCATOR_FLAGS)
    REGCODE(ERESOURCE_INVALID_RELEASE)
    REGCODE(CLUSTER_CSV_STATE_TRANSITION_INTERVAL_TIMEOUT_LIVEDUMP)
    REGCODE(CLUSTER_CSV_CLUSSVC_DISCONNECT_WATCHDOG)
    REGCODE(CRYPTO_LIBRARY_INTERNAL_ERROR)
    REGCODE(COREMSGCALL_INTERNAL_ERROR)
    REGCODE(COREMSG_INTERNAL_ERROR)
    REGCODE(PREVIOUS_FATAL_ABNORMAL_RESET_ERROR)
    REGCODE(ELAM_DRIVER_DETECTED_FATAL_ERROR)
    REGCODE(CLUSTER_CLUSPORT_STATUS_IO_TIMEOUT_LIVEDUMP)
    REGCODE(PROFILER_CONFIGURATION_ILLEGAL)
    REGCODE(PDC_LOCK_WATCHDOG_LIVEDUMP)
    REGCODE(PDC_UNEXPECTED_REVOCATION_LIVEDUMP)
    REGCODE(MICROCODE_REVISION_MISMATCH)
    REGCODE(WVR_LIVEDUMP_REPLICATION_IOCONTEXT_TIMEOUT)
    REGCODE(WVR_LIVEDUMP_STATE_TRANSITION_TIMEOUT)
    REGCODE(WVR_LIVEDUMP_RECOVERY_IOCONTEXT_TIMEOUT)
    REGCODE(WVR_LIVEDUMP_APP_IO_TIMEOUT)
    REGCODE(WVR_LIVEDUMP_MANUALLY_INITIATED)
    REGCODE(WVR_LIVEDUMP_STATE_FAILURE)
    REGCODE(WVR_LIVEDUMP_CRITICAL_ERROR)
    REGCODE(VIDEO_DWMINIT_TIMEOUT_FALLBACK_BDD)
    REGCODE(CLUSTER_CSVFS_LIVEDUMP)
    REGCODE(BAD_OBJECT_HEADER)
    REGCODE(SILO_CORRUPT)
    REGCODE(SECURE_KERNEL_ERROR)
    REGCODE(HYPERGUARD_VIOLATION)
    REGCODE(SECURE_FAULT_UNHANDLED)
    REGCODE(KERNEL_PARTITION_REFERENCE_VIOLATION)
    REGCODE(WIN32K_CRITICAL_FAILURE_LIVEDUMP)
    REGCODE(PF_DETECTED_CORRUPTION)
    REGCODE(KERNEL_AUTO_BOOST_LOCK_ACQUISITION_WITH_RAISED_IRQL)
    REGCODE(VIDEO_DXGKRNL_LIVEDUMP)
    REGCODE(KERNEL_STORAGE_SLOT_IN_USE)
    REGCODE(SMB_SERVER_LIVEDUMP)
    REGCODE(LOADER_ROLLBACK_DETECTED)
    REGCODE(WIN32K_SECURITY_FAILURE)
    REGCODE(UFX_LIVEDUMP)
    REGCODE(WORKER_THREAD_RETURNED_WHILE_ATTACHED_TO_SILO)
    REGCODE(TTM_FATAL_ERROR)
    REGCODE(WIN32K_POWER_WATCHDOG_TIMEOUT)
    REGCODE(CLUSTER_SVHDX_LIVEDUMP)
    REGCODE(BUGCODE_NETADAPTER_DRIVER)
    REGCODE(PDC_PRIVILEGE_CHECK_LIVEDUMP)
    REGCODE(TTM_WATCHDOG_TIMEOUT)
    REGCODE(WIN32K_CALLOUT_WATCHDOG_LIVEDUMP)
    REGCODE(WIN32K_CALLOUT_WATCHDOG_BUGCHECK)
    REGCODE(CALL_HAS_NOT_RETURNED_WATCHDOG_TIMEOUT_LIVEDUMP)
    REGCODE(DRIPS_SW_HW_DIVERGENCE_LIVEDUMP)
    REGCODE(USB_DRIPS_BLOCKER_SURPRISE_REMOVAL_LIVEDUMP)
    REGCODE(BLUETOOTH_ERROR_RECOVERY_LIVEDUMP)
    REGCODE(SMB_REDIRECTOR_LIVEDUMP)
    REGCODE(DRIVER_VERIFIER_DETECTED_VIOLATION_LIVEDUMP)
    REGCODE(IO_THREADPOOL_DEADLOCK_LIVEDUMP)
    REGCODE(FAST_ERESOURCE_PRECONDITION_VIOLATION)
    REGCODE(STORE_DATA_STRUCTURE_CORRUPTION)
    REGCODE(MANUALLY_INITIATED_POWER_BUTTON_HOLD)
    REGCODE(USER_MODE_HEALTH_MONITOR_LIVEDUMP)
    REGCODE(SYNTHETIC_WATCHDOG_TIMEOUT)
    REGCODE(INVALID_SILO_DETACH)
    REGCODE(EXRESOURCE_TIMEOUT_LIVEDUMP)
    REGCODE(INVALID_CALLBACK_STACK_ADDRESS)
    REGCODE(INVALID_KERNEL_STACK_ADDRESS)
    REGCODE(HARDWARE_WATCHDOG_TIMEOUT)
    REGCODE(ACPI_FIRMWARE_WATCHDOG_TIMEOUT)
    REGCODE(TELEMETRY_ASSERTS_LIVEDUMP)
    REGCODE(WORKER_THREAD_INVALID_STATE)
    REGCODE(WFP_INVALID_OPERATION)
    REGCODE(UCMUCSI_LIVEDUMP)
    REGCODE(DRIVER_PNP_WATCHDOG)
    REGCODE(WORKER_THREAD_RETURNED_WITH_NON_DEFAULT_WORKLOAD_CLASS)
    REGCODE(EFS_FATAL_ERROR)
    REGCODE(UCMUCSI_FAILURE)
    REGCODE(XBOX_ERACTRL_CS_TIMEOUT)
    REGCODE(XBOX_CORRUPTED_IMAGE)
    REGCODE(XBOX_INVERTED_FUNCTION_TABLE_OVERFLOW)
    REGCODE(XBOX_CORRUPTED_IMAGE_BASE)
    REGCODE(XBOX_360_SYSTEM_CRASH)
    REGCODE(XBOX_360_SYSTEM_CRASH_RESERVED)
    REGCODE(HYPERVISOR_ERROR)
    REGCODE(WINLOGON_FATAL_ERROR)
    REGCODE(MANUALLY_INITIATED_CRASH1)
    REGCODE(BUGCHECK_CONTEXT_MODIFIER)
};

static LPTSTR bug_code2msg(DWORD dwCode)
{
    return MsgFromSys(FORMAT_MESSAGE_FROM_HMODULE, hModKrnl, dwCode);
}

static void bug_freemsg(LPTSTR lpMessage)
{
    LocalFree(lpMessage);
}

void EcRegBug(ErrorCodeSet *pecs)
{
    pecs->lpName = TEXT("System");
    pecs->pfnMessageFromCode = bug_code2msg;
    pecs->pfnFreeMessage = bug_freemsg;
    pecs->items = ec_bug_items;
    pecs->dwCodeCount = ARRAYSIZE(ec_bug_items);
}

void EcUnregBug()
{
    /* Ignore */
}

